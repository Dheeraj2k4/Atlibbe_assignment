{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Link}from'react-router-dom';import{useReports}from'../../contexts/ReportContext';import{useAuth}from'../../contexts/AuthContext';import reportService from'../../services/reportService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";/**\n * Report List Component\n * Displays a list of reports, optionally filtered by product ID\n */const ReportList=_ref=>{let{productId,limit}=_ref;const{reports,userReports,refreshReports,deleteReport,isLoading,error}=useReports();const{isAdmin}=useAuth();const[displayReports,setDisplayReports]=useState([]);const[isDeleting,setIsDeleting]=useState({});// Load reports on component mount and when productId changes\nuseEffect(()=>{const loadReports=async()=>{try{if(productId){const productReports=await reportService.getReportsByProduct(productId);setDisplayReports(productReports);}else{// Use reports from context\nsetDisplayReports(isAdmin?reports:userReports);}}catch(err){console.error('Error loading reports:',err);}};loadReports();},[productId,reports,userReports,isAdmin,refreshReports]);// Apply limit if specified\nconst limitedReports=limit?displayReports.slice(0,limit):displayReports;/**\n   * Handle report deletion\n   * @param reportId Report ID to delete\n   */const handleDelete=async reportId=>{if(window.confirm('Are you sure you want to delete this report?')){setIsDeleting(prev=>({...prev,[reportId]:true}));try{await deleteReport(reportId);}catch(err){console.error('Error deleting report:',err);}finally{setIsDeleting(prev=>({...prev,[reportId]:false}));}}};/**\n   * Format date for display\n   * @param date Date to format\n   */const formatDate=date=>{return new Date(date).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'});};/**\n   * Get report type display name\n   * @param type Report type\n   */const getReportTypeDisplay=type=>{const types={standard:'Standard',detailed:'Detailed',summary:'Summary',custom:'Custom'};return types[type]||type.charAt(0).toUpperCase()+type.slice(1);};if(isLoading&&displayReports.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading reports...\"});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error});}if(displayReports.length===0){return/*#__PURE__*/_jsxs(\"div\",{className:\"no-reports\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"No reports found.\"}),productId&&/*#__PURE__*/_jsx(Link,{to:`/products/${productId}/generate-report`,className:\"button\",children:\"Generate Report\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"report-list-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"report-list\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Report Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Created Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Filename\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:limitedReports.map(report=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:getReportTypeDisplay(report.report_type)}),/*#__PURE__*/_jsx(\"td\",{children:formatDate(report.created_at)}),/*#__PURE__*/_jsx(\"td\",{children:report.filename}),/*#__PURE__*/_jsxs(\"td\",{className:\"actions\",children:[/*#__PURE__*/_jsx(Link,{to:`/reports/${report._id}`,className:\"view-button\",children:\"View\"}),/*#__PURE__*/_jsx(\"a\",{href:reportService.getReportDownloadUrl(report.filename),className:\"download-button\",target:\"_blank\",rel:\"noopener noreferrer\",children:\"Download\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-button\",onClick:()=>handleDelete(report._id),disabled:isDeleting[report._id],children:isDeleting[report._id]?'Deleting...':'Delete'})]})]},report._id))})]})}),productId&&/*#__PURE__*/_jsx(\"div\",{className:\"report-actions\",children:/*#__PURE__*/_jsx(Link,{to:`/products/${productId}/generate-report`,className:\"button\",children:\"Generate New Report\"})}),limit&&displayReports.length>limit&&/*#__PURE__*/_jsx(\"div\",{className:\"view-all\",children:/*#__PURE__*/_jsx(Link,{to:\"/reports\",children:\"View All Reports\"})})]});};export default ReportList;","map":{"version":3,"names":["React","useEffect","useState","Link","useReports","useAuth","reportService","jsx","_jsx","jsxs","_jsxs","ReportList","_ref","productId","limit","reports","userReports","refreshReports","deleteReport","isLoading","error","isAdmin","displayReports","setDisplayReports","isDeleting","setIsDeleting","loadReports","productReports","getReportsByProduct","err","console","limitedReports","slice","handleDelete","reportId","window","confirm","prev","formatDate","date","Date","toLocaleDateString","year","month","day","getReportTypeDisplay","type","types","standard","detailed","summary","custom","charAt","toUpperCase","length","className","children","to","map","report","report_type","created_at","filename","_id","href","getReportDownloadUrl","target","rel","onClick","disabled"],"sources":["C:/Users/Dheeraj/Desktop/Altibbe_assignemnt/frontend/src/components/reports/ReportList.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useReports } from '../../contexts/ReportContext';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { Report } from '../../services/reportService';\nimport reportService from '../../services/reportService';\n\ninterface ReportListProps {\n  productId?: string;\n  limit?: number;\n}\n\n/**\n * Report List Component\n * Displays a list of reports, optionally filtered by product ID\n */\nconst ReportList: React.FC<ReportListProps> = ({ productId, limit }) => {\n  const { reports, userReports, refreshReports, deleteReport, isLoading, error } = useReports();\n  const { isAdmin } = useAuth();\n  const [displayReports, setDisplayReports] = useState<Report[]>([]);\n  const [isDeleting, setIsDeleting] = useState<Record<string, boolean>>({});\n\n  // Load reports on component mount and when productId changes\n  useEffect(() => {\n    const loadReports = async () => {\n      try {\n        if (productId) {\n          const productReports = await reportService.getReportsByProduct(productId);\n          setDisplayReports(productReports);\n        } else {\n          // Use reports from context\n          setDisplayReports(isAdmin ? reports : userReports);\n        }\n      } catch (err) {\n        console.error('Error loading reports:', err);\n      }\n    };\n\n    loadReports();\n  }, [productId, reports, userReports, isAdmin, refreshReports]);\n\n  // Apply limit if specified\n  const limitedReports = limit ? displayReports.slice(0, limit) : displayReports;\n\n  /**\n   * Handle report deletion\n   * @param reportId Report ID to delete\n   */\n  const handleDelete = async (reportId: string) => {\n    if (window.confirm('Are you sure you want to delete this report?')) {\n      setIsDeleting((prev) => ({ ...prev, [reportId]: true }));\n      try {\n        await deleteReport(reportId);\n      } catch (err) {\n        console.error('Error deleting report:', err);\n      } finally {\n        setIsDeleting((prev) => ({ ...prev, [reportId]: false }));\n      }\n    }\n  };\n\n  /**\n   * Format date for display\n   * @param date Date to format\n   */\n  const formatDate = (date: Date | string) => {\n    return new Date(date).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n    });\n  };\n\n  /**\n   * Get report type display name\n   * @param type Report type\n   */\n  const getReportTypeDisplay = (type: string) => {\n    const types: Record<string, string> = {\n      standard: 'Standard',\n      detailed: 'Detailed',\n      summary: 'Summary',\n      custom: 'Custom',\n    };\n    return types[type] || type.charAt(0).toUpperCase() + type.slice(1);\n  };\n\n  if (isLoading && displayReports.length === 0) {\n    return <div className=\"loading\">Loading reports...</div>;\n  }\n\n  if (error) {\n    return <div className=\"error-message\">{error}</div>;\n  }\n\n  if (displayReports.length === 0) {\n    return (\n      <div className=\"no-reports\">\n        <p>No reports found.</p>\n        {productId && (\n          <Link to={`/products/${productId}/generate-report`} className=\"button\">\n            Generate Report\n          </Link>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"report-list-container\">\n      <div className=\"report-list\">\n        <table>\n          <thead>\n            <tr>\n              <th>Report Type</th>\n              <th>Created Date</th>\n              <th>Filename</th>\n              <th>Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {limitedReports.map((report) => (\n              <tr key={report._id}>\n                <td>{getReportTypeDisplay(report.report_type)}</td>\n                <td>{formatDate(report.created_at)}</td>\n                <td>{report.filename}</td>\n                <td className=\"actions\">\n                  <Link to={`/reports/${report._id}`} className=\"view-button\">\n                    View\n                  </Link>\n                  <a \n                    href={reportService.getReportDownloadUrl(report.filename)} \n                    className=\"download-button\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    Download\n                  </a>\n                  <button\n                    className=\"delete-button\"\n                    onClick={() => handleDelete(report._id)}\n                    disabled={isDeleting[report._id]}\n                  >\n                    {isDeleting[report._id] ? 'Deleting...' : 'Delete'}\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n      \n      {productId && (\n        <div className=\"report-actions\">\n          <Link to={`/products/${productId}/generate-report`} className=\"button\">\n            Generate New Report\n          </Link>\n        </div>\n      )}\n      \n      {limit && displayReports.length > limit && (\n        <div className=\"view-all\">\n          <Link to=\"/reports\">View All Reports</Link>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ReportList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}