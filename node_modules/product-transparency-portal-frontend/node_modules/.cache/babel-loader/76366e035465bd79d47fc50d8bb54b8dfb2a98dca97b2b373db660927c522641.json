{"ast":null,"code":"import axios from 'axios';\nimport { API_URL } from '../config';\n\n// Types\n\n// Local storage key\nconst TOKEN_KEY = 'auth_token';\nconst USER_KEY = 'user_data';\n\n/**\n * Authentication Service\n * Handles user authentication, registration, and profile management\n */\nconst authService = {\n  /**\n   * Register a new user\n   * @param userData User registration data\n   * @returns User data with token\n   */\n  async register(userData) {\n    try {\n      const response = await axios.post(`${API_URL}/auth/register`, userData);\n      if (response.data.success) {\n        this.setToken(response.data.data.token);\n        this.setUser(response.data.data);\n        return response.data.data;\n      }\n      throw new Error('Registration failed');\n    } catch (error) {\n      var _error$response, _error$response$data;\n      throw new Error(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Registration failed');\n    }\n  },\n  /**\n   * Login user\n   * @param credentials User login credentials\n   * @returns User data with token\n   */\n  async login(credentials) {\n    try {\n      const response = await axios.post(`${API_URL}/auth/login`, credentials);\n      if (response.data.success) {\n        this.setToken(response.data.data.token);\n        this.setUser(response.data.data);\n        return response.data.data;\n      }\n      throw new Error('Login failed');\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      throw new Error(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || 'Login failed');\n    }\n  },\n  /**\n   * Logout user\n   */\n  logout() {\n    localStorage.removeItem(TOKEN_KEY);\n    localStorage.removeItem(USER_KEY);\n  },\n  /**\n   * Get user profile\n   * @returns User profile data\n   */\n  async getProfile() {\n    try {\n      const response = await axios.get(`${API_URL}/auth/profile`, {\n        headers: this.authHeader()\n      });\n      if (response.data.success) {\n        // Update stored user data with latest profile\n        const userData = {\n          ...this.getUser(),\n          ...response.data.data\n        };\n        this.setUser(userData);\n        return userData;\n      }\n      throw new Error('Failed to get profile');\n    } catch (error) {\n      var _error$response3, _error$response4, _error$response4$data;\n      if (((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) === 401) {\n        this.logout();\n      }\n      throw new Error(((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.error) || 'Failed to get profile');\n    }\n  },\n  /**\n   * Update user profile\n   * @param updateData Profile update data\n   * @returns Updated user data\n   */\n  async updateProfile(updateData) {\n    try {\n      const response = await axios.put(`${API_URL}/auth/profile`, updateData, {\n        headers: this.authHeader()\n      });\n      if (response.data.success) {\n        // Update stored user data with updated profile\n        const userData = {\n          ...this.getUser(),\n          ...response.data.data\n        };\n        this.setUser(userData);\n        return userData;\n      }\n      throw new Error('Failed to update profile');\n    } catch (error) {\n      var _error$response5, _error$response5$data;\n      throw new Error(((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.error) || 'Failed to update profile');\n    }\n  },\n  /**\n   * Check if user is logged in\n   * @returns True if user is logged in\n   */\n  isLoggedIn() {\n    return !!this.getToken();\n  },\n  /**\n   * Check if user is admin\n   * @returns True if user is admin\n   */\n  isAdmin() {\n    const user = this.getUser();\n    return (user === null || user === void 0 ? void 0 : user.role) === 'admin';\n  },\n  /**\n   * Get authentication header\n   * @returns Authentication header object\n   */\n  authHeader() {\n    const token = this.getToken();\n    return token ? {\n      Authorization: `Bearer ${token}`\n    } : {};\n  },\n  /**\n   * Set authentication token\n   * @param token JWT token\n   */\n  setToken(token) {\n    localStorage.setItem(TOKEN_KEY, token);\n  },\n  /**\n   * Get authentication token\n   * @returns JWT token\n   */\n  getToken() {\n    return localStorage.getItem(TOKEN_KEY);\n  },\n  /**\n   * Set user data\n   * @param user User data\n   */\n  setUser(user) {\n    localStorage.setItem(USER_KEY, JSON.stringify(user));\n  },\n  /**\n   * Get user data\n   * @returns User data\n   */\n  getUser() {\n    const userData = localStorage.getItem(USER_KEY);\n    return userData ? JSON.parse(userData) : null;\n  }\n};\nexport default authService;","map":{"version":3,"names":["axios","API_URL","TOKEN_KEY","USER_KEY","authService","register","userData","response","post","data","success","setToken","token","setUser","Error","error","_error$response","_error$response$data","login","credentials","_error$response2","_error$response2$data","logout","localStorage","removeItem","getProfile","get","headers","authHeader","getUser","_error$response3","_error$response4","_error$response4$data","status","updateProfile","updateData","put","_error$response5","_error$response5$data","isLoggedIn","getToken","isAdmin","user","role","Authorization","setItem","getItem","JSON","stringify","parse"],"sources":["C:/Users/Dheeraj/Desktop/Altibbe_assignemnt/frontend/src/services/authService.ts"],"sourcesContent":["import axios from 'axios';\nimport { API_URL } from '../config';\n\n// Types\nexport interface UserData {\n  _id: string;\n  name: string;\n  email: string;\n  role: string;\n  token: string;\n}\n\nexport interface LoginCredentials {\n  email: string;\n  password: string;\n}\n\nexport interface RegisterData extends LoginCredentials {\n  name: string;\n}\n\nexport interface UpdateProfileData {\n  name?: string;\n  email?: string;\n  password?: string;\n}\n\n// Local storage key\nconst TOKEN_KEY = 'auth_token';\nconst USER_KEY = 'user_data';\n\n/**\n * Authentication Service\n * Handles user authentication, registration, and profile management\n */\nconst authService = {\n  /**\n   * Register a new user\n   * @param userData User registration data\n   * @returns User data with token\n   */\n  async register(userData: RegisterData): Promise<UserData> {\n    try {\n      const response = await axios.post(`${API_URL}/auth/register`, userData);\n      if (response.data.success) {\n        this.setToken(response.data.data.token);\n        this.setUser(response.data.data);\n        return response.data.data;\n      }\n      throw new Error('Registration failed');\n    } catch (error: any) {\n      throw new Error(error.response?.data?.error || 'Registration failed');\n    }\n  },\n\n  /**\n   * Login user\n   * @param credentials User login credentials\n   * @returns User data with token\n   */\n  async login(credentials: LoginCredentials): Promise<UserData> {\n    try {\n      const response = await axios.post(`${API_URL}/auth/login`, credentials);\n      if (response.data.success) {\n        this.setToken(response.data.data.token);\n        this.setUser(response.data.data);\n        return response.data.data;\n      }\n      throw new Error('Login failed');\n    } catch (error: any) {\n      throw new Error(error.response?.data?.error || 'Login failed');\n    }\n  },\n\n  /**\n   * Logout user\n   */\n  logout(): void {\n    localStorage.removeItem(TOKEN_KEY);\n    localStorage.removeItem(USER_KEY);\n  },\n\n  /**\n   * Get user profile\n   * @returns User profile data\n   */\n  async getProfile(): Promise<UserData> {\n    try {\n      const response = await axios.get(`${API_URL}/auth/profile`, {\n        headers: this.authHeader(),\n      });\n      if (response.data.success) {\n        // Update stored user data with latest profile\n        const userData = { ...this.getUser(), ...response.data.data };\n        this.setUser(userData);\n        return userData;\n      }\n      throw new Error('Failed to get profile');\n    } catch (error: any) {\n      if (error.response?.status === 401) {\n        this.logout();\n      }\n      throw new Error(error.response?.data?.error || 'Failed to get profile');\n    }\n  },\n\n  /**\n   * Update user profile\n   * @param updateData Profile update data\n   * @returns Updated user data\n   */\n  async updateProfile(updateData: UpdateProfileData): Promise<UserData> {\n    try {\n      const response = await axios.put(`${API_URL}/auth/profile`, updateData, {\n        headers: this.authHeader(),\n      });\n      if (response.data.success) {\n        // Update stored user data with updated profile\n        const userData = { ...this.getUser(), ...response.data.data };\n        this.setUser(userData);\n        return userData;\n      }\n      throw new Error('Failed to update profile');\n    } catch (error: any) {\n      throw new Error(error.response?.data?.error || 'Failed to update profile');\n    }\n  },\n\n  /**\n   * Check if user is logged in\n   * @returns True if user is logged in\n   */\n  isLoggedIn(): boolean {\n    return !!this.getToken();\n  },\n\n  /**\n   * Check if user is admin\n   * @returns True if user is admin\n   */\n  isAdmin(): boolean {\n    const user = this.getUser();\n    return user?.role === 'admin';\n  },\n\n  /**\n   * Get authentication header\n   * @returns Authentication header object\n   */\n  authHeader(): { Authorization: string } | {} {\n    const token = this.getToken();\n    return token ? { Authorization: `Bearer ${token}` } : {};\n  },\n\n  /**\n   * Set authentication token\n   * @param token JWT token\n   */\n  setToken(token: string): void {\n    localStorage.setItem(TOKEN_KEY, token);\n  },\n\n  /**\n   * Get authentication token\n   * @returns JWT token\n   */\n  getToken(): string | null {\n    return localStorage.getItem(TOKEN_KEY);\n  },\n\n  /**\n   * Set user data\n   * @param user User data\n   */\n  setUser(user: UserData): void {\n    localStorage.setItem(USER_KEY, JSON.stringify(user));\n  },\n\n  /**\n   * Get user data\n   * @returns User data\n   */\n  getUser(): UserData | null {\n    const userData = localStorage.getItem(USER_KEY);\n    return userData ? JSON.parse(userData) : null;\n  },\n};\n\nexport default authService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}